import"./script-DaepQuN0.js";import{J as i}from"./just-validate.es-C73wyOde.js";import{I as l}from"./inputmask-CsGDK5Eu.js";import{a as d,c,d as m,b as I,e as p}from"./firebase-BaZ254dP.js";class g{emailInputId;passwordInputId;nameInputId;surnameInputId;phoneInputId;constructor(e,r,s,a,t){this.emailInputId=e,this.passwordInputId=r,this.nameInputId=s,this.surnameInputId=a,this.phoneInputId=t}getElementById(e){const r=document.getElementById(e);if(!r)throw new Error(`Element with id "${e}" not found.`);return r}async saveUserToDatabase(e,r,s,a,t,o){const n=await d(c(m,"users"),{uid:e,role:r,email:s,name:a,surname:t,phone:o});console.log("Document written with ID: ",n.id),document.cookie=`UID=${e}`}async createAccount(){const e=this.getElementById(this.emailInputId).value,r=this.getElementById(this.passwordInputId).value,s=this.getElementById(this.nameInputId).value,a=this.getElementById(this.surnameInputId).value,t=this.getElementById(this.phoneInputId).value;console.log(e,r,s,a,t);try{const n=(await I(p,e,r)).user.uid;await this.saveUserToDatabase(n,"user",e,s,a,t),console.log(n)}catch(o){console.error("There was an error:",o),this.showLoginError(o)}}showLoginError(e){console.error("Login error:",e)}}class h{formId;validator;constructor(e){this.formId=e,this.validator=new i(this.formId),this.applyMasks(),this.initializeValidation()}applyMasks(){l({mask:"+99 (999) 999 99 99",placeholder:" "}).mask(document.querySelector("#tel"))}initializeValidation(){this.validator.addField("#name",[{rule:"required",errorMessage:"Ведіть iм'я"},{rule:"minLength",value:2,errorMessage:"Iм'я має містити більше символів"},{rule:"customRegexp",value:/^[А-Яа-яЁёІіЇїЄєҐґA-Za-z]{2,}$/,errorMessage:"Iм'я має містити лише літери"}]).addField("#surname",[{rule:"required",errorMessage:"Ведіть прізвище"},{rule:"minLength",value:2,errorMessage:"Прізвище має містити більше символів"},{rule:"customRegexp",value:/^[А-Яа-яЁёІіЇїЄєҐґA-Za-z]{2,}$/,errorMessage:"Прізвище має містити лише літери"}]).addField("#email",[{rule:"required",errorMessage:"Ведіть пошту"},{rule:"customRegexp",value:/^[-\w.]+@([а-яёa-z0-9][-A-z0-9]+\.)+[A-z]{2,4}$/,errorMessage:"Напишіть правильну пошту"}]).addField("#tel",[{rule:"required",errorMessage:"Ведіть номер телефону"}]).addField("#password",[{rule:"required",errorMessage:"Ведіть пароль"},{rule:"minLength",value:6,errorMessage:"Довжина не менше 6 символів"},{rule:"customRegexp",value:/[a-z]/,errorMessage:"Пароль повинен мати тільки англійські літери"},{rule:"customRegexp",value:/[A-Z]/,errorMessage:"Пароль повинен містити велику літеру"},{rule:"customRegexp",value:/[0-9]/,errorMessage:"Пароль повинен містити цифру"}]).onSuccess(e=>{e.preventDefault(),new g("email","password","name","surname","tel").createAccount()})}}document.addEventListener("DOMContentLoaded",async()=>{new h("#form-reg")});
